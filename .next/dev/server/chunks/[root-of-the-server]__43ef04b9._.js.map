{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/duke/Documents/GitHub/GradDrive/app/api/download/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\n\nexport async function GET(request: NextRequest) {\n  const searchParams = request.nextUrl.searchParams;\n  const fileUrl = searchParams.get('url');\n  const filename = searchParams.get('filename');\n\n  if (!fileUrl) {\n    return NextResponse.json({ error: 'Missing file URL' }, { status: 400 });\n  }\n\n  try {\n    // Fetch the file from Firebase Storage (server-side, no CORS issues)\n    const response = await fetch(fileUrl, {\n      method: 'GET',\n      headers: {\n        'User-Agent': 'GradDrive-Downloader/1.0',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to fetch file: ${response.statusText}`);\n    }\n\n    // Get the file as a blob\n    const blob = await response.blob();\n\n    // Return the file with proper download headers\n    return new NextResponse(blob, {\n      headers: {\n        'Content-Type': blob.type || 'application/octet-stream',\n        'Content-Disposition': `attachment; filename=\"${filename || 'download'}\"`,\n        'Content-Length': blob.size.toString(),\n      },\n    });\n  } catch (error) {\n    console.error('Download error:', error);\n    return NextResponse.json(\n      { error: 'Failed to download file' },\n      { status: 500 }\n    );\n  }\n}\n\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,IAAI,OAAoB;IAC5C,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY;IACjD,MAAM,UAAU,aAAa,GAAG,CAAC;IACjC,MAAM,WAAW,aAAa,GAAG,CAAC;IAElC,IAAI,CAAC,SAAS;QACZ,OAAO,sPAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAmB,GAAG;YAAE,QAAQ;QAAI;IACxE;IAEA,IAAI;QACF,qEAAqE;QACrE,MAAM,WAAW,MAAM,MAAM,SAAS;YACpC,QAAQ;YACR,SAAS;gBACP,cAAc;YAChB;QACF;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,IAAI,MAAM,CAAC,sBAAsB,EAAE,SAAS,UAAU,EAAE;QAChE;QAEA,yBAAyB;QACzB,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,+CAA+C;QAC/C,OAAO,IAAI,sPAAY,CAAC,MAAM;YAC5B,SAAS;gBACP,gBAAgB,KAAK,IAAI,IAAI;gBAC7B,uBAAuB,CAAC,sBAAsB,EAAE,YAAY,WAAW,CAAC,CAAC;gBACzE,kBAAkB,KAAK,IAAI,CAAC,QAAQ;YACtC;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mBAAmB;QACjC,OAAO,sPAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA0B,GACnC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}